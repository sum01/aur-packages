# Maintainer: sum01 <sum01@protonmail.com>
pkgname=tribler-git
_srcname="tribler"
pkgver=r12781.cddfbad06
pkgrel=1
pkgdesc="Privacy enhanced BitTorrent client with P2P content discovery."
url="https://github.com/Tribler/tribler"
arch=('i686' 'x86_64')
license=('LGPL3')
depends=('libsodium' 'libtorrent-rasterbar' 'python2-pyqt5' 'qt5-svg' 'phonon-qt5-vlc' 'python2-apsw' 'python2-cherrypy' 'python2-cryptography' 'python2-decorator' 'python2-dnspython' 'python2-ecdsa' 'python2-feedparser' 'python2-chardet' 'python2-jsonrpclib' 'python2-keyring' 'python2-keyrings-alt' 'python2-m2crypto' 'python2-netifaces' 'python2-pbkdf2' 'python2-plyvel' 'python2-protobuf' 'python2-pysocks' 'python2-requests' 'python2-pyaes' 'python2-twisted' 'python2-configobj' 'python2-matplotlib' 'python2-libnacl' 'python2-networkx' 'python2-scipy')
makedepends=('git')
conflicts=('tribler')
source=("git+https://github.com/Tribler/tribler.git")
sha512sums=('SKIP')
pkgver(){
  cd "$srcdir/$_srcname"
  printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
}
prepare(){
  cd "$srcdir/$_srcname/"
  git submodule init
  git submodule update
}
package() {
  cd "$srcdir/$_srcname"
  mkdir -p "$pkgdir"/usr/{bin,share/{applications,pixmaps,icons/hicolor/48x48/apps}}/
  install -m755 debian/bin/tribler "$pkgdir/usr/bin/"
  install -m644 Tribler/Main/Build/Ubuntu/tribler.desktop "$pkgdir/usr/share/applications/"
  install -m644 TriblerGUI/images/tribler.png "$pkgdir/usr/share/icons/hicolor/48x48/apps/"
  install -m644 Tribler/Main/Build/Ubuntu/tribler.xpm "$pkgdir/usr/share/pixmaps/"
  install -m644 Tribler/Main/Build/Ubuntu/tribler_big.xpm "$pkgdir/usr/share/pixmaps/"
  mv "$srcdir/$_srcname" "$pkgdir/usr/share/"
}
